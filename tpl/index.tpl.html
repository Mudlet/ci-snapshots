<!DOCTYPE HTML>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="robots" content="noindex, nofollow" />

<link rel="shortcut icon" href="https://make.mudlet.org/snapshots/favicon.ico">

<link rel="stylesheet" href="https://make.mudlet.org/snapshots/tpl/css/fa5.8.2-all.min.css">

<style>
body,td,th {
  font-family: "Open Sans", Arial, Helvetica, sans-serif;
  font-size: 1em;
  color: #000;
}
body {
  background-color: #222;
  margin-left: 0px;
  margin-top: 0px;
  margin-right: 0px;
  margin-bottom: 0px;
}
img {
  vertical-align: bottom;
}

a, a:link {
  color: #a54b03;
}
a:visited {
  color: #9a5c34;
}
a:hover, a:active {
  color: #dc4c00;
}

header {
  background: url('https://make.mudlet.org/snapshots/tpl/img/mudlet-header-bgtile.png');
  border-bottom: 1px solid #eae1bb;
  max-height: 80px;
}
header .logo-link {
  display: inline-block;
  margin-left: 16px;
}
header nav {
  float: right;
  margin-top: 16px;
}
header nav a {
  display: inline-block;
  font-weight: bold;
  text-decoration: none;
  font-size: 1em;
  margin-right: 12px;
  padding-top: 16px;
  padding-bottom: 16px;
  padding-left: 4px;
  padding-right: 4px;
}

section.bg-white {
  background-color: #FFF;
  display: inline-block;
  width: 100%;
}
section.bg-white h1 {
  font-size: 1.5em;
}
section.bg-white h2 {
  font-size: 1.15em;
}
section.bg-white h1,
section.bg-white h2 {
  margin-left: 12px;
}
section.bg-white.compact {
  text-align: center;
}
section.bg-white.compact h1,
section.bg-white.compact h2 {
  margin-left: 0px;
}
section.bg-white p {
  margin-left: 1.1em;
}

footer {
  color: #efefef;
  padding: 12px;
  font-size: 0.8em;
}


.filelist {
  display: inline-flex;
  flex-direction: column;
  list-style-type: none;
  list-style-position: initial;
  list-style-image: initial;
  padding: 0px;
  width: 100%;
}
.compact .filelist {
  width: auto;
}
.filelist-item {
  flex: 1;
  padding: 5px;
  padding-left: 12px;
  padding-right: 12px;
  text-align: left;
}
.filelist-item:nth-child(even) {
  background: #efefef;
}
.fileinfo {
  float: right;
}
.filesize {
  width: 70px;
  display: inline-block;
  text-align: center;
}
.filedls {
  width: 70px;
  display: inline-block;
  text-align: center;
}
.filetime {
  width: 170px;
  display: inline-block;
  text-align: center;
  word-spacing: 5px;
}
.filegitlinks {
  width: 70px;
  display: inline-block;
  text-align: right;
}
.filegitlinks a {
  margin-right: 12px;
}
.filegitlinks a:last-child {
  margin-right: 0px;
}

.platform-icon {
    font-size: 1.3em;
    vertical-align: middle;
    padding-right: 0.4em;
}

.hinfo {
  text-align: center;
  font-weight: bold;
  font-size: 1.1em;
  list-style-type: none;
  list-style-position: initial;
  list-style-image: initial;
  padding-bottom: 6px;
  margin-bottom: 10px;
  border-bottom: 1px solid rgb(170,170,170);
}
.hinfo .filetime {
  text-align: center;
}
.hinfo .filegitlinks {
  text-align: center;
}

.filter-ctrl {
    margin-left: 1.4em;
    margin-top: 2em;
}

.masterlist {
  display: none;
  visibility: hidden;
}

.latest-branch-files span {
  margin-top: 3px;
  margin-bottom: 3px;
  display: inline-block;
}
.latest-branch-files label {
  width: 100px;
  text-align: right;
  margin-right: 6px;
  display: inline-block;
}

</style>

<title>Mudlet Pull-Request Snapshots</title>

</head>
<body>
<header>
  <a class="logo-link" href="{SITE_URL}"><img src="https://make.mudlet.org/snapshots/tpl/img/mudlet-wp-logo.png" alt="Mudlet Logo" title="Mudlet Logo" /></a>
  <nav>
    <a href="https://www.mudlet.org/">Home</a>
    <a href="https://wiki.mudlet.org/">Wiki</a>
    <a href="https://forums.mudlet.org/">Forum</a>
  </nav>
</header>
<section class="bg-white">
  <h1>Available Snapshot Files</h1>
  <p>This page lists "Snapshots" of the Mudlet software built through Continuous Integration services as a result of commits and pull requests to the <a href="https://github.com/Mudlet/Mudlet">Mudlet repository on Github.com</a><br/>
  These files are made available to enable easier testing of software changes but cannot be stored indefinitely.<br/>
  All times are shown in <span class="pg-timezone">{pg_timezone}</span></p>
  
  <div class="latest-branch-files">
    <h2>Latest Branch Snapshots</h2>
    <p>{latest_branch_snapshots}</p>
  </div>
  
  <div class="filter-ctrl">
    Show only files for: 
    <select name="platform_filter" id="platform_filter">
      <option value="all">All Platforms</option>
      <option value="windows">Windows</option>
      <option value="linux">Linux</option>
      <option value="macos">Mac OS</option>
    </select>
    in
    <select name="source_filter" id="source_filter">
      <option value="all">Branches &amp; PRs</option>
      <option value="branch">Branches Only</option>
      <option value="pull-request">Pull-Requests Only</option>
    </select>
    Remember via Cookie: <input type="checkbox" name="filter_cookie" id="filter_cookie" value="1">
  </div>
  {snapshot_list}
</section>
<footer>
  All times are in <span class="pg-timezone">{pg_timezone}</span> - {pg_size_listed} Storage Used - 
  Made with <i class="fas fa-heart" aria-hidden="true" title="heart"></i><span class="sr-only">heart</span>, 
  <i class="fas fa-coffee" aria-hidden="true" title="coffee"></i><span class="sr-only">coffee</span>, and You.
</footer>

<script src="https://make.mudlet.org/snapshots/tpl/js/js.cookie.js"></script>
<script src="https://make.mudlet.org/snapshots/tpl/js/jquery-3.4.1.slim.min.js"></script>
<script>
  var hasClonedList = false;
  
  function getQueryParams() {
    var currentURL = window.location.search.substring(1);
    var currentParams = currentURL.split('&');
    var params = [];
    for (var i = 0; i < currentParams.length; i++) {
      var paramData = currentParams[i].split('=');
      params.push(paramData[0]);
      params[paramData[0]] = paramData[1];
    }
    return params;
  }
  function getQueryParam(name)  {
    var params = getQueryParams();
    if ( name in params ) {
      return params[name];
    } else {
      return undefined;
    }
  }
  
  function setPageUrlParams(params) {
    if (window.history.pushState) {
      pageUrl = window.location.pathname;
      pageUrl += '?' + $.param(params);
      
      window.history.pushState({}, null, pageUrl);
      return true;
    }
    return false;
  }
  
  function setFilterCookie(cookieName, platVal, srcVal) {
    var CookieOpts = {expires: 365};
    var CookieValue = {platform: platVal, source: srcVal};
    Cookies.set(cookieName, CookieValue, CookieOpts);
  }
  
  function padZero(i) {
    if (i < 10) {
        i = "0" + i;
    }
    return i;
  }
  
  function showListItems(platform, source) {
    if ( hasClonedList == false ) {
      // Clone original list, with local conversions, for use in filtering.
      var $masterList = $('<ul class="masterlist"></ul>');
      var $clonedList = $('.filelist-item').clone();
      $clonedList.appendTo($masterList);
      $masterList.appendTo('section.bg-white');
      hasClonedList = true;
    }
  
    $('ul.filelist .filelist-item').remove();
    if (platform == 'all') {
      if (source == 'all') {
        $('ul.masterlist .filelist-item').clone().appendTo('ul.filelist');
      } else {
        $('ul.masterlist .filelist-item.'+ source).clone().appendTo('ul.filelist');
      }
    } else {
      if (source == 'all') {
        $('ul.masterlist .filelist-item.'+ platform ).clone().appendTo('ul.filelist');
      } else {
        $('ul.masterlist .filelist-item.'+ platform + '.'+ source ).clone().appendTo('ul.filelist');
      }
    }
    
    setPageUrlParams({'platform':platform, 'source':source});
  }
  
  $(document).ready(function(){
    var pg_timezone = $.trim($('span.pg-timezone:first').text());
    var sys_timezone = '';
    var filterCookieName  = 'snapshots_show_only';
    var filterCookieValue = Cookies.getJSON(filterCookieName);
    
    $('.filelist-item .filetime').each(function(idx){
      var timeStr = $(this).data('isotime');
      var dateObj = new Date(timeStr);
      var opts = {
        hour12: false,
        day:    '2-digit',
        month:  '2-digit',
        year:   'numeric',
        hour:   '2-digit',
        minute: '2-digit'
      };
      var localFormattedTime = dateObj.toLocaleDateString('default', opts);
      localFormattedTime = localFormattedTime.replace(',', '');
      localFormattedTime = localFormattedTime.replace(new RegExp('/', 'g'), '-');
      $(this).text(localFormattedTime);
      
      if( sys_timezone == '' ) {
        var topts = {
          timeZoneName: 'short'
        }
        var tmpDateStr = dateObj.toLocaleDateString('default', topts).split(" ");
        sys_timezone = tmpDateStr[ (tmpDateStr.length - 1) ];
      }
    });
    
    $('span.pg-timezone').html( "local time <em>(" + sys_timezone + ")</em> <!-- converted from " + pg_timezone + " -->");
    
    $('#platform_filter').on('change', function() {
      var source_filter_val = $('#source_filter').val();
    
      showListItems( this.value, source_filter_val );
      if ( typeof filterCookieValue !== 'undefined' ) {
        if ( $('#filter_cookie').is(':checked') ) {
          setFilterCookie(filterCookieName, this.value, source_filter_val);
        }
      }
    });
    
    $('#source_filter').on('change', function() {
      var platform_filter_val = $('#platform_filter').val();
      
      showListItems( platform_filter_val, this.value );
      if ( typeof filterCookieValue !== 'undefined' ) {
        if ( $('#filter_cookie').is(':checked') ) {
          setFilterCookie(filterCookieName, platform_filter_val, this.value);
        }
      }
    });
    
    $('#filter_cookie').on('change', function() {
      if ( $(this).is(':checked') ) {
        var platform_filter_val = $('#platform_filter').val();
        var source_filter_val = $('#source_filter').val();
        
        setFilterCookie(filterCookieName, platform_filter_val, source_filter_val);
      } else {
        Cookies.remove(filterCookieName);
      }
    });
    
    if ( typeof filterCookieValue !== 'undefined' ) {
      $('#filter_cookie').prop('checked', true);
      $('#platform_filter').val(filterCookieValue.platform);
      $('#source_filter').val(filterCookieValue.source);
      
      setTimeout('showListItems("'+ filterCookieValue.platform +'", "'+ filterCookieValue.source +'")', 250);
    }
    
    if ( getQueryParams().length > 0 ) {
      var urlFilterPlatform = getQueryParam('platform');
      var urlFilterSource = getQueryParam('source');
      if ( typeof urlFilterPlatform !== 'undefined' || typeof urlFilterSource !== 'undefined' ) 
      {
        var validPlatforms = ['windows','linux','macos'];
        var validSources = ['branch','pull-request'];
        if (validPlatforms.indexOf(urlFilterPlatform) == -1) {
          urlFilterPlatform = 'all';
        }
        if (validSources.indexOf(urlFilterSource) == -1) {
          urlFilterSource = 'all';
        }
        
        $('#platform_filter').val(urlFilterPlatform);
        $('#source_filter').val(urlFilterSource);
        
        setTimeout('showListItems("'+ urlFilterPlatform +'", "'+ urlFilterSource +'")', 250);
      }
    }
    
    
  });
</script>

</body>
</html>